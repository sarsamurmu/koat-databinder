/*!
 * Koat DataBinder v1.0.0
 * Copyright (c) 2019 Sarsa Murmu
 * https://github.com/sarsamurmu/koat-databinder
 */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("DataBinder",[],t):"object"==typeof exports?exports.DataBinder=t():e.DataBinder=t()}(window,(function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t,r){const{dt:n,getType:i,types:a}=r(1),o=r(2).default;e.exports=class{constructor(e,t){Reflect.defineProperty(this,n,{value:{},writable:!0,enumerable:!1,configurable:!1}),this[n].element=e,this[n].binderData={},this[n].baseHTML=e.outerHTML.repeat(1).trim().replace(/(<(pre|script|style|textarea)[^]+?<\/\2)|(^|>)\s+|\s+(?=<|$)/g,"$1$3").replace(/\{:((\s|.)*?):\}/g,e=>e.replace(/(?<!\\)&gt;/g,">").replace(/(?<!\\)&lt;/g,"<").replace(/(?<!\\)&amp;&amp;/g,"&&")).replace(/\{:(.*?):\}=[\"\']{2}/g,"{:$1:}"),this[n].connected=!1,this[n].proxyHandler={get:(e,t)=>Reflect.get(e,t),set:(e,t,r)=>(Reflect.set(e,t,this[n].getProxiefied(r)),this[n].connected&&this.update(),!0)},this[n].proxiefy=e=>{Object.keys(e).forEach(t=>{let r=i(e[t]);if(r===a.Object&&(this[n].proxiefy(e[t]),e[t]=new Proxy(e[t],this[n].proxyHandler)),r===a.Array){for(var o=0;o<e[t].length;o++){let r=i(e[t][o]);r!==a.Object&&r!==a.Array||(this[n].proxiefy(e[t][o]),e[t][o]=new Proxy(e[t][o],this[n].proxyHandler))}e[t]=new Proxy(e[t],this[n].proxyHandler)}})},this[n].getProxiefied=e=>{let t=i(e);return t===a.Object||t===a.Array?(this[n].proxiefy(e),new Proxy(e,this[n].proxyHandler)):e},this[n].setupWatcher=e=>{void 0!==e&&Object.keys(e).forEach(t=>{this[t]=this[n].binderData[t]=this[n].getProxiefied(e[t]),Reflect.defineProperty(this,t,{enumerable:!0,configurable:!0,get:()=>this[n].binderData[t],set:e=>(this[n].binderData[t]=this[n].getProxiefied(e),this[n].connected&&this.update(),!0)})})},this[n].setupWatcher(t),this[n].JSONreplacer=(e,t)=>"function"==typeof t?t.bind(this)():t,this[n].updateLetString=()=>{this[n].letString="",Object.keys(this).forEach(e=>{this[n].binderData[e]=this[e];var t=JSON.stringify(this[n].binderData[e],this[n].JSONreplacer);this[n].letString+=`let ${e} = ${t};`})},this[n].getNewHTML=()=>this[n].baseHTML.replace(/a\{:(.*?):\}/g,(e,t,r)=>{var i=t.trim();return Function(`${this[n].letString} let __scrtVal__ = '${i}'; try { __scrtVal__ += '="'+${i}+'"' } catch (e) { console.warn(e.toString()); __scrtVal__ = '' } return __scrtVal__`)()}).replace(/\{:((\s|.)*?):\}/gm,(e,t,r)=>{var i=t.trim();return Function(`${this[n].letString} let __scrtVal__ = ''; try { __scrtVal__ = ${i} } catch (e) { console.warn(e.toString()); __scrtVal__ = '' } return __scrtVal__`)()})}update(){this[n].updateLetString(),o(this[n].element,this[n].getNewHTML(),{onBeforeElUpdated:function(e,t){return!e.isEqualNode(t)}})}set(e,t){this[n].binderData[e]=this[n].getProxiefied(t),Reflect.defineProperty(this,e,{enumerable:!0,configurable:!0,get:()=>this[n].binderData[e],set:t=>(this[n].binderData[e]=this[n].getProxiefied(t),this[n].connected&&this.update(),!0)})}connect(){this[n].connected=!0,this.update()}disconnect(){this[n].connected=!1}}},function(e,t){e.exports={dt:"_#koatBinder#_",getType:e=>Object.prototype.toString.call(e),types:{Array:"[object Array]",Object:"[object Object]"}}},function(e,t,r){"use strict";r.r(t);var n,i=11;var a="http://www.w3.org/1999/xhtml",o="undefined"==typeof document?void 0:document,l=!!o&&"content"in o.createElement("template"),d=!!o&&o.createRange&&"createContextualFragment"in o.createRange();function c(e){return e=e.trim(),l?function(e){var t=o.createElement("template");return t.innerHTML=e,t.content.childNodes[0]}(e):d?function(e){return n||(n=o.createRange()).selectNode(o.body),n.createContextualFragment(e).childNodes[0]}(e):function(e){var t=o.createElement("body");return t.innerHTML=e,t.childNodes[0]}(e)}function u(e,t){var r=e.nodeName,n=t.nodeName;return r===n||!!(t.actualize&&r.charCodeAt(0)<91&&n.charCodeAt(0)>90)&&r===n.toUpperCase()}function s(e,t,r){e[r]!==t[r]&&(e[r]=t[r],e[r]?e.setAttribute(r,""):e.removeAttribute(r))}var f={OPTION:function(e,t){var r=e.parentNode;if(r){var n=r.nodeName.toUpperCase();"OPTGROUP"===n&&(n=(r=r.parentNode)&&r.nodeName.toUpperCase()),"SELECT"!==n||r.hasAttribute("multiple")||(e.hasAttribute("selected")&&!t.selected&&(e.setAttribute("selected","selected"),e.removeAttribute("selected")),r.selectedIndex=-1)}s(e,t,"selected")},INPUT:function(e,t){s(e,t,"checked"),s(e,t,"disabled"),e.value!==t.value&&(e.value=t.value),t.hasAttribute("value")||e.removeAttribute("value")},TEXTAREA:function(e,t){var r=t.value;e.value!==r&&(e.value=r);var n=e.firstChild;if(n){var i=n.nodeValue;if(i==r||!r&&i==e.placeholder)return;n.nodeValue=r}},SELECT:function(e,t){if(!t.hasAttribute("multiple")){for(var r,n,i=-1,a=0,o=e.firstChild;o;)if("OPTGROUP"===(n=o.nodeName&&o.nodeName.toUpperCase()))o=(r=o).firstChild;else{if("OPTION"===n){if(o.hasAttribute("selected")){i=a;break}a++}!(o=o.nextSibling)&&r&&(o=r.nextSibling,r=null)}e.selectedIndex=i}}},p=1,h=11,b=3,m=8;function v(){}function g(e){return e.id}var y=function(e){return function(t,r,n){if(n||(n={}),"string"==typeof r)if("#document"===t.nodeName||"HTML"===t.nodeName){var i=r;(r=o.createElement("html")).innerHTML=i}else r=c(r);var l=n.getNodeKey||g,d=n.onBeforeNodeAdded||v,s=n.onNodeAdded||v,y=n.onBeforeElUpdated||v,x=n.onElUpdated||v,N=n.onBeforeNodeDiscarded||v,_=n.onNodeDiscarded||v,S=n.onBeforeElChildrenUpdated||v,T=!0===n.childrenOnly,A=Object.create(null),O=[];function C(e){O.push(e)}function P(e,t,r){!1!==N(e)&&(t&&t.removeChild(e),_(e),function e(t,r){if(t.nodeType===p)for(var n=t.firstChild;n;){var i=void 0;r&&(i=l(n))?C(i):(_(n),n.firstChild&&e(n,r)),n=n.nextSibling}}(e,r))}function E(e){s(e);for(var t=e.firstChild;t;){var r=t.nextSibling,n=l(t);if(n){var i=A[n];i&&u(t,i)&&(t.parentNode.replaceChild(i,t),j(i,t))}E(t),t=r}}function j(t,r,n){var i=l(r);if(i&&delete A[i],!n){if(!1===y(t,r))return;if(e(t,r),x(t),!1===S(t,r))return}"TEXTAREA"!==t.nodeName?function(e,t){var r,n,i,a,c,s=t.firstChild,h=e.firstChild;e:for(;s;){for(a=s.nextSibling,r=l(s);h;){if(i=h.nextSibling,s.isSameNode&&s.isSameNode(h)){s=a,h=i;continue e}n=l(h);var v=h.nodeType,g=void 0;if(v===s.nodeType&&(v===p?(r?r!==n&&((c=A[r])?i===c?g=!1:(e.insertBefore(c,h),n?C(n):P(h,e,!0),h=c):g=!1):n&&(g=!1),(g=!1!==g&&u(h,s))&&j(h,s)):v!==b&&v!=m||(g=!0,h.nodeValue!==s.nodeValue&&(h.nodeValue=s.nodeValue))),g){s=a,h=i;continue e}n?C(n):P(h,e,!0),h=i}if(r&&(c=A[r])&&u(c,s))e.appendChild(c),j(c,s);else{var y=d(s);!1!==y&&(y&&(s=y),s.actualize&&(s=s.actualize(e.ownerDocument||o)),e.appendChild(s),E(s))}s=a,h=i}!function(e,t,r){for(;t;){var n=t.nextSibling;(r=l(t))?C(r):P(t,e,!0),t=n}}(e,h,n);var x=f[e.nodeName];x&&x(e,t)}(t,r):f.TEXTAREA(t,r)}!function e(t){if(t.nodeType===p||t.nodeType===h)for(var r=t.firstChild;r;){var n=l(r);n&&(A[n]=r),e(r),r=r.nextSibling}}(t);var w,V,D=t,R=D.nodeType,H=r.nodeType;if(!T)if(R===p)H===p?u(t,r)||(_(t),D=function(e,t){for(var r=e.firstChild;r;){var n=r.nextSibling;t.appendChild(r),r=n}return t}(t,(w=r.nodeName,(V=r.namespaceURI)&&V!==a?o.createElementNS(V,w):o.createElement(w)))):D=r;else if(R===b||R===m){if(H===R)return D.nodeValue!==r.nodeValue&&(D.nodeValue=r.nodeValue),D;D=r}if(D===r)_(t);else{if(r.isSameNode&&r.isSameNode(D))return;if(j(D,r,T),O)for(var U=0,L=O.length;U<L;U++){var M=A[O[U]];M&&P(M,M.parentNode,!1)}}return!T&&D!==t&&t.parentNode&&(D.actualize&&(D=D.actualize(t.ownerDocument||o)),t.parentNode.replaceChild(D,t)),D}}((function(e,t){var r,n,a,o,l=t.attributes;if(t.nodeType!==i&&e.nodeType!==i){for(var d=0;d<l.length;d++)n=(r=l[d]).name,a=r.namespaceURI,o=r.value,a?(n=r.localName||n,e.getAttributeNS(a,n)!==o&&("xmlns"===r.prefix&&(n=r.name),e.setAttributeNS(a,n,o))):e.getAttribute(n)!==o&&e.setAttribute(n,o);for(var c=e.attributes,u=0;u<c.length;u++)n=(r=c[u]).name,(a=r.namespaceURI)?(n=r.localName||n,t.hasAttributeNS(a,n)||e.removeAttributeNS(a,n)):t.hasAttribute(n)||e.removeAttribute(n)}}));t.default=y}])}));